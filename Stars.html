<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Spinning Galaxy</title>
    <style>
        body {
            margin: 0;
            display: flex;
            justify-content: center;
            align-items: center;
            overflow: hidden;
            height: 100vh;
            background-color: black;
            flex-direction: column;
        }

        .canvasContainer {
        position: absolute;
        width: 100vw;
        height: 100vh;
        }
        
        #galaxyCanvas {
            border: 1px solid rgba(9, 132, 21, 0.314); /* Optional: just to show the canvas boundaries */
        }
        #starfieldCanvas {
            border: 1px solid rgb(35, 28, 243); /* Optional: just to show the canvas boundaries */
        }

        .canvasContainer {
            position: relative;
            display: flex;
            justify-content: center;
            align-items: center;
        }
    </style>
</head>
<body>

    <div class="canvasContainer", id="canvasContainer">
        <canvas id="starfieldCanvas" width="1600" height="1200" style="position: absolute; z-index: 1;"></canvas>
        <canvas id="galaxyCanvas" width="1600" height="1200" style="position: absolute; z-index: 2;"></canvas>
    </div>

    <script>
        // Constants
        const CANVAS_WIDTH = 1600;
        const CANVAS_HEIGHT = 1200;
        const TWO_PI = Math.PI * 2;

        // DOM Elements; Get canvas and context
        const starfieldCanvas = document.getElementById('starfieldCanvas');
        const galaxyCanvas = document.getElementById('galaxyCanvas');
        const starfieldCtx = starfieldCanvas.getContext('2d');
        const galaxyCtx = galaxyCanvas.getContext('2d');

        // Helper function for calculating coordinates
        function calculateCoordinates(radius, angle, centerX, centerY) {
            return {
                x: centerX + radius * Math.cos(angle),
                y: centerY + radius * Math.sin(angle)
            };
        }

        // Function to get a random star color based on common star types
        function getRandomStarColor() {
            const types = ['#94D0FF', '#AEEEEE', '#7F00FF']; // Light Blue, Turquoise, Purple
            const weights = [0.4, 0.3, 0.2, 0.08, 0.02];
            let sum = 0;
            const random = Math.random();

            for (let i = 0; i < types.length; i++) {
                sum += weights[i];
                if (random < sum) {
                    return types[i];
                }
            }
            return 'white';
        }
        // Function to draw diffuse star field in background
        function drawDiffuseStarfield() {
        const numberOfStars = 1000;
        for (let i = 0; i < numberOfStars; i++) {
            const x = Math.random() * starfieldCanvas.width;
            const y = Math.random() * starfieldCanvas.height;
            const brightness = 0.2 + 0.3 * Math.random();
            const color = `rgba(${255 * brightness}, ${255 * brightness}, ${240 * brightness}, 1)`;
            starfieldCtx.fillStyle = color;
            const size = .2 + Math.random() * 1;
            starfieldCtx.fillRect(x, y, size, size);
        }
    }
        // Function to generate stars in a spiral pattern
        function generateGalaxy(starCount, arms) {
            let starsData = [];
            let nucleusStarCount = starCount / 0.75;
            let nucleusRadius = CANVAS_WIDTH / 9;

        // Generate nucleus stars
        for (let i = 0; i < nucleusStarCount; i++) {
            let angle = Math.random() * TWO_PI;
            let randomFactor = Math.random();
            let radius = Math.sqrt(1 - randomFactor) * nucleusRadius;
            let coords = calculateCoordinates(radius, angle, CANVAS_WIDTH / 2, CANVAS_HEIGHT / 2);
            let size = randomFactor * 0.75 + 0.5;
            let color = getRandomStarColor();
            starsData.push({ ...coords, size, color });
        }

        // Generate spiral arm stars
        for (let i = 0; i < starCount; i++) {
            for (let j = 0; j < arms; j++) {
                let angle = (i / starCount) * TWO_PI + (TWO_PI / arms) * j;
                let spiralFactor = i / starCount;
                let taperFactor = Math.pow(spiralFactor, 1.5);
                let randomOffset = (1 - taperFactor) * (Math.random() * 150 - 50);
                let radius = taperFactor * CANVAS_WIDTH / 3 + randomOffset;
                let coords = calculateCoordinates(radius, angle, CANVAS_WIDTH / 2, CANVAS_HEIGHT / 2);
                let size = Math.random() * Math.random() * 2 * (1 - taperFactor) + 0.5;
                let color = getRandomStarColor();
                starsData.push({ ...coords, size, color });
            }
        }

        return starsData;
    }

    // Predefined stars - Add your custom stars here
    let predefinedStars = [
        {x: galaxyCanvas.width / 2 + 50, y: galaxyCanvas.height / 2, size: 1, color: 'blue', id: 'star1'},
        //{x: 100, y: 150, size: 1, color: 'blue', id: 'star1'},
        //{x: 100, y: 150, size: 1, color: 'red', id: 'star2'},
        //{x: 100, y: 150, size: 1, color: 'white', id: 'star3'},
        // ...other predefined stars
    ];

    // Combine predefined and random stars
    let randomStars = generateGalaxy(1000, 4);  // Now with 4 spiral arms
    let allStars = [...predefinedStars, ...randomStars];

    function drawGalaxyGradient() {
        // Define the center of the gradient
        let x = starfieldCanvas.width / 2;
        let y = starfieldCanvas.height / 2;

        // Define the radius of the entire gradient
        let outerRadius = Math.sqrt((starfieldCanvas.width * starfieldCanvas.width) + (starfieldCanvas.height * starfieldCanvas.height)) / 8;
        
        // Create the radial gradient
        // You can adjust the inner radius (0 here) if you want to start the gradient from a certain radius outwards
        let gradient = starfieldCtx.createRadialGradient(x, y, 0, x, y, outerRadius);

        // Define color stops for the gradient
        gradient.addColorStop(0, 'rgba(255, 255, 255, 0.1)'); // Semi-transparent white
        gradient.addColorStop(0.1, 'rgba(0, 191, 255, 0.1)');
        gradient.addColorStop(0.3, 'rgba(0, 0, 128, 0.1)');
        gradient.addColorStop(0.4, 'rgba(46, 46, 46, 0.1)'); // Lighter black, grayer
        gradient.addColorStop(0.6, 'rgba(28, 28, 28, 0.1)'); // Dark gray
        gradient.addColorStop(0.9, 'rgba(0, 0, 0, 0.1)'); // Nearing black
        gradient.addColorStop(1, 'rgba(0, 0, 0, 0.1)'); // Outer space, no stars

        // Apply the gradient as a fill style
        starfieldCtx.fillStyle = gradient;
        starfieldCtx.fillRect(0, 0, starfieldCanvas.width, starfieldCanvas.height);
}

    function drawStars(context) {
    for (let i = 0; i < numStars; i++) {
        let x = Math.random() * galaxyCanvas.width;
        let y = Math.random() * galaxyCanvas.height;
        let radius = Math.random() * 1.2;
        let gradient = context.createRadialGradient(x, y, 0, x, y, radius);
        
        gradient.addColorStop(0, 'rgba(255, 255, 255, 1)');
        gradient.addColorStop(0.1, 'rgba(202, 202, 202, 1)');
        gradient.addColorStop(1, 'rgba(0, 0, 0, 0)');
        
        context.beginPath();
        context.arc(x, y, radius, 0, 2 * Math.PI, false);
        context.fillStyle = gradient;
        context.fill();
    }
}
        // Animation variables
        let angle = 0;

        // Animation function
        function animate() {
            drawDiffuseStarfield();
            drawGalaxyGradient();
            galaxyCtx.save()
            galaxyCtx.clearRect(0, 0, galaxyCanvas.width, galaxyCanvas.height);
            galaxyCtx.save();
            galaxyCtx.translate(galaxyCanvas.width / 2, galaxyCanvas.height / 2);
            galaxyCtx.rotate(angle);
            galaxyCtx.translate(-galaxyCanvas.width / 2, -galaxyCanvas.height / 2);

            // Drawing stars using starsData (both nucleus and spiral stars)
            allStars.forEach(star => {
                galaxyCtx.fillStyle = star.color;
                galaxyCtx.beginPath();
                galaxyCtx.arc(star.x, star.y, star.size, 0, TWO_PI, false);
                galaxyCtx.fill();
            });
            
            galaxyCtx.restore();
            angle -= 0.0002;
            requestAnimationFrame(animate);
        }
    // Entry Point function
    const init = () => {
    drawDiffuseStarfield();
    drawGalaxyGradient();
    animate();    
    };

    init();

    /* Interaction: Show image on hover over predefined star
    canvas.addEventListener('mousemove', function(event) {
        let rect = canvas.getBoundingClientRect();
        let mouseX = event.clientX - rect.left;
        let mouseY = event.clientY - rect.top;
        
        predefinedStars.forEach(star => {
            let distance = Math.sqrt((star.x - mouseX)**2 + (star.y - mouseY)**2);
            if (distance < star.size) {
                showImage(star);  // Define this function to show an image
            }
        });
    });
    */ 

    /* Function to show image - Customize this function as needed
    function showImage(star) {
        console.log('Hovered over star with id:', star.id);
        // Your code to display an image or other information related to the star
    }
    */

</script>
</body>
</html>
